{% extends "base.html" %}
{% block content %}
<!-- Start Banner Area -->
<section class="banner-area organic-breadcrumb">
    <div class="container">
        <div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
            <div class="col-first">
                <h1>Order Summary</h1>
            </div>
        </div>
    </div>
</section>
<!-- End Banner Area -->
<!--================checkout Area =================-->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css"
    integrity="sha384-r4NyP46KrjDleawBgD5tp8Y7UzmLA05oM1iAEQ17CSuDqnUK2+k9luXQOfXJCJ4I" crossorigin="anonymous" />
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
    </script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js"
    integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/" crossorigin="anonymous">
    </script>
<div class="cart_area">
    <div class="container">
        <a class="card-header btn" data-toggle="collapse" href="#multiCollapseExample1">ORDER SUMMARY</a>
        <div class="collapse multi-collapse" id="multiCollapseExample1">
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">Product</th>
                            <th scope="col">Price</th>
                            <th scope="col">Quantity</th>
                            <th scope="col">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Row Start -->

                        {% for items in data %}
                        <tr>
                            <td>
                                <div class="media">
                                    <div class="d-flex">
                                        <img class="cart_image" src="..{{data[items]['image']}}" alt="">
                                    </div>
                                    <div class="media-body">
                                        <p>{{data[items]['productname']}}</p>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <h5>${{data[items]['price']}}</h5>
                            </td>
                            <td>
                                <div class="product_count">
                                    <input type="text" name="qty" maxlength="12" value="{{data[items]['count']}}"
                                        title="Quantity:" class="input-text qty" disabled>
                                </div>
                            </td>
                            <td>
                                <h5>${{data[items]['count']*data[items]['price']}}</h5>
                            </td>
                        </tr>
                        {% endfor %}
                        <!-- End Row -->

                        <tr>
                            <td></td>
                            <td></td>
                            <td>
                                <h4 style="font-weight: 600;">TOTAL AMOUNT</h4>
                            </td>
                            <td>
                                <h4 style="font-weight: 600;">${{totalprice}}</h4>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="container">
    <a class="card-header btn" data-toggle="collapse" data-target="#multiCollapseExample2">
        DELIVERY ADDRESS
    </a>
    <div class="collapse multi-collapse" id="multiCollapseExample2">
        <div class="card card-body">
            This is second element
        </div>
    </div>
</div>


<!--================ end checkout Area =================-->
<div class="container">
    <div class="btn" style="background-color: aquamarine;">
        <a class="card-header" data-toggle="collapse" data-target="#multiCollapseExample3">
            PAYMENT
        </a>
    </div>
    <div class="collapse multi-collapse" id="multiCollapseExample3">
        <div class="card card-body">
            <form action="{{url_for('pay')}}" method="POST">
                <script src="https://checkout.razorpay.com/v1/checkout.js" , data-key="rzp_test_aFHgpPQ2Qr3esy" ,
                    data-amount="{{amount}}" , data-currency="INR" , data-order_id="{{payment['order_id']}}" ,
                    data-name="Jaggu Bhai" , data-buttontext="Pay With Razorpay" , data-description="Pay Your Money Now"
                    , data-theme.color="#3399cc">
                    </script>
                <input type="hidden" custom="Hidden Element" name="hidden">
            </form>
            </script>
        </div>
    </div>
</div>
{% endblock %}











    <!-- <button id="rzp-button1">Pay Now</button>
            <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
            <script>
                var razorpay_payment_id, razorpay_order_id, razorpay_signature;
                var options = {
                    "key": "rzp_test_aFHgpPQ2Qr3esy", // Enter the Key ID generated from the Dashboard
                    "amount": 200, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
                    "currency": "INR",
                    "name": "Jaggu Bhai",
                    "description": "Buy Sports Tshirts",
                    "image": "https://next.razorpay.com/build/browser/static/razorpay-logo-white.c637804f.svg",
                    "order_id": "{{payment['id']}}", //This is a sample Order ID. Pass the `id` obtained in the response of Step 2
                    "handler": function (response) {
                        console.log("completed successfully")
                        console.log(response.razorpay_payment_id)
                        razorpay_payment_id = response.razorpay_payment_id
                        razorpay_order_id = response.razorpay_order_id
                        razorpay_signature = response.razorpay_signature
                        alert(response.razorpay_payment_id);
                        alert(response.razorpay_order_id);
                        alert(response.razorpay_signature)
                    },
                    "theme": {
                        "color": "#3399cc"
                    }
                };
                console.log(options)
                var rzp1 = new Razorpay(options);
                rzp1.on('payment.failed', function (response) {
                    alert(response.error.code);
                    alert(response.error.description);
                    alert(response.error.source);
                    alert(response.error.step);
                    alert(response.error.reason);
                    alert(response.error.metadata.order_id);
                    alert(response.error.metadata.payment_id);
                });
                document.getElementById('rzp-button1').onclick = function (e) {
                    rzp1.open();
                    e.preventDefault();
                }
                generated_signature = hmac_sha256(order_id + "|" + razorpay_payment_id, secret);

                if (generated_signature == razorpay_signature) {
                    console.log("payment is successful")
                } -->